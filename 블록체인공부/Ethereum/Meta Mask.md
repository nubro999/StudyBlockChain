
## MetaMask란?

**MetaMask**는  
- **이더리움 및 EVM 호환 블록체인 지갑**으로,
- 브라우저 확장 프로그램(크롬, 파이어폭스 등)과 모바일 앱 형태로 제공됩니다.
- 사용자가 **블록체인 네트워크에 안전하게 접속**하고,  
  **토큰 관리, 트랜잭션 서명, 디앱(DApp)과의 연동**을 쉽게 할 수 있게 해줍니다.

---

## MetaMask의 동작 원리

### 1. **비밀키(Private Key)와 주소 관리**

- MetaMask는 사용자의 **비밀키(Private Key)**를 **로컬(사용자 컴퓨터/브라우저)**에서 암호화하여 저장합니다.
- **지갑 주소**(공개키 기반)는 비밀키로부터 파생됩니다.
- **중앙 서버에 비밀키를 저장하지 않으므로**, 사용자가 직접 비밀키/시드 구문(복구 구문)을 안전하게 보관해야 합니다.

---

### 2. **블록체인 네트워크와의 연결**

- MetaMask는 기본적으로 **Infura** 같은 외부 이더리움 노드 서비스에 연결되어 블록체인 데이터(잔액, 트랜잭션 등)를 조회합니다.
- 사용자는 네트워크(메인넷, 테스트넷, 커스텀 RPC 등)를 직접 추가하거나 변경할 수 있습니다.

---

### 3. **디앱(DApp)과의 연동**

- **웹사이트(디앱)**가 MetaMask와 통신하려면 **Web3 API**, 최근에는 **EIP-1193 표준**을 따르는 `window.ethereum` 객체를 사용합니다.
- 디앱이 사용자의 지갑 주소나 트랜잭션 서명을 요청하면,  
  MetaMask가 사용자에게 **승인/거부**를 묻는 창을 띄웁니다.
- 사용자가 승인하면, MetaMask가 **트랜잭션에 서명**하고, 블록체인 네트워크로 전송합니다.

---

### 4. **트랜잭션 서명과 전송**

- 디앱이 트랜잭션 데이터를 보내면, MetaMask는 해당 데이터를 사용자에게 보여주고 **서명**을 요청합니다.
- 사용자가 승인하면, **비밀키로 트랜잭션에 디지털 서명**을 하고,  
  이를 블록체인 네트워크에 전파합니다.
- 이 과정에서 비밀키는 절대 외부로 노출되지 않습니다.

---

### 5. **토큰 관리**

- MetaMask는 기본적으로 이더(ETH) 외에도 다양한 ERC-20, ERC-721(대체불가토큰, NFT) 토큰을 관리할 수 있습니다.
- 사용자는 토큰 컨트랙트 주소를 추가하여 새로운 토큰을 지갑에서 관리할 수 있습니다.

---

## 요약 흐름도

1. **지갑 생성/복구** → 비밀키 및 주소 로컬 저장
2. **네트워크 연결**(Infura 등 노드)
3. **디앱이 MetaMask 요청** → `window.ethereum` 사용
4. **사용자 승인** → 트랜잭션 서명/전송
5. **결과 확인** → 블록체인 상태 조회

---

## 보안 원칙

- **비밀키/시드 구문은 오직 사용자 컴퓨터에만 저장**  
- **MetaMask는 중앙 서버에 사용자의 개인 정보를 저장하지 않음**  
- **모든 트랜잭션 서명은 로컬에서 이루어짐**  
- **피싱 사이트, 악성코드 주의 필요**

---

## 참고: 디앱에서 MetaMask 사용 예시

```javascript
// 지갑 연결 요청
await window.ethereum.request({ method: 'eth_requestAccounts' });

// 트랜잭션 서명 예시
const tx = {
  to: "0x1234...",
  value: "0x29a2241af62c0000", // 3 ETH in hex
};
await window.ethereum.request({
  method: 'eth_sendTransaction',
  params: [tx],
});
```

## “연결”의 의미

### ✅ 연결 전

- 디앱은 **누가 이 사이트에 접속했는지 모름**
- 사용자의 **지갑 주소**나 **잔액 정보**를 알 수 없음
- **트랜잭션(송금, NFT 구매 등)**을 할 수 없음

### ✅ 연결 후

- 디앱이 **사용자의 지갑 주소(공개키)**를 알 수 있음
- 사용자의 **잔액, NFT 목록** 등 블록체인 데이터를 읽을 수 있음
- 사용자가 **트랜잭션을 보낼 때(예: 결제, NFT 민팅)**  
    MetaMask 등 지갑이 서명 및 전송을 대행해줌